<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Messzeit.ch – Röm.-kath. Messzeiten</title>
  <!-- 引入优雅法式斜体字体 -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@1,600&display=swap" rel="stylesheet">
  <style>
    body {
      margin:0;
      font-family: "Helvetica Neue", Arial, sans-serif;
      background:#faf9f7;
      color:#2b2b2b;
      text-align:center;
      line-height:1.7;
    }
    header {
      padding:50px 20px 30px;
    }
    header img.logo {
      max-width:110px;
      height:auto;
      margin-bottom:18px;
    }
    h1 {
      margin:0.2em 0;
      font-size:44px;
      font-family: 'Playfair Display', serif;
      font-style:italic;
      font-weight:600;
      color:#2c2418;
      letter-spacing:1px;
    }
    p.subtitle {
      margin:0;
      font-size:19px;
      color:#7a6b59;
      font-style:italic;
    }
    .contact-email {
      margin-top:20px;
      font-size:17px;
      color:#444;
      display:inline-block;
      padding:8px 14px;
      border:1px solid #ddd;   /* 浅灰色边框 */
      border-radius:8px;       /* 圆角 */
      background:#fffefa;      /* 微暖白背景 */
    }
    .contact-email a {
      color:#b49440;
      text-decoration:none;
      font-weight:500;
    }
    .contact-email a:hover {
      text-decoration:underline;
    }
    .store-buttons {
      margin-top:40px;
      display:flex;
      justify-content:center;
      gap:20px;
    }
    .store-buttons img {
      height:60px;
      cursor:pointer;
      transition:transform 0.2s;
    }
    .store-buttons img:hover {
      transform:scale(1.05);
    }
    main {
      padding:40px 20px;
    }
    main h2 {
      font-size:26px;
      font-style:italic;
      font-weight:500;
      margin-bottom:12px;
      color:#3c332b;
    }
    main p {
      font-size:18px;
      color:#555;
      max-width:600px;
      margin:0 auto 20px;
    }
    .submit-change {
      margin-top:30px;
    }
    .submit-change a {
      display:inline-block;
      padding:12px 20px;
      border-radius:10px;
      background:#d6b86b;
      color:#fff;
      text-decoration:none;
      font-weight:600;
      transition:background 0.2s;
    }
    .submit-change a:hover {
      background:#b49440;
    }
    footer {
      margin-top:60px;
      padding:20px;
      background:#f1eee8;
      color:#555;
      font-size:13px;
      font-weight:400;
      font-style:normal;
    }
  </style>

  <!-- 🔔 OneSignal Push Notification -->
  <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
  <script>
    window.OneSignalDeferred = window.OneSignalDeferred || [];
    OneSignalDeferred.push(async function(OneSignal) {
      await OneSignal.init({
        appId: "162a5f05-9720-4b73-9634-37218a31f3bb", // 替换成你的 App ID
      });
    });
  </script>
</head>
<script>
(async function(){
  try {
    const r = await fetch('/api/today.json', {cache:'no-store'});
    if(!r.ok) return;
    const data = await r.json();
    if(!Array.isArray(data) || !data.length) return;

    const box = document.createElement('div');
    box.style.maxWidth='720px';
    box.style.margin='30px auto';
    box.style.textAlign='left';
    box.innerHTML = '<h3 style="text-align:center;margin:0 0 12px;font-style:italic;">Heutige Messen</h3>';

    data.forEach(ev=>{
      const d = new Date(ev.start);
      const time = d.toLocaleTimeString('de-CH',{hour:'2-digit', minute:'2-digit'});
      const line = document.createElement('div');
      line.style.padding='8px 0';
      line.textContent = `${time} — ${ev.title}${ev.location ? ' @ ' + ev.location : ''}`;
      box.appendChild(line);
    });

    document.body.appendChild(box);
  } catch (e) {
    console.warn('today.json failed', e);
  }
})();
</script>
  
<body>
  <header>
    <!-- Logo -->
    <img src="logo.png" alt="Messzeit Logo" class="logo">

    <h1>Messzeit.ch</h1>
    <p class="subtitle">Römisch-katholische Messzeiten in der Schweiz</p>

    <!-- Email -->
    <div class="contact-email">
      Kontakt: <a href="mailto:info@messzeit.ch">info@messzeit.ch</a>
    </div>
  </header>

  <!-- Änderung melden / 提交更改 -->
  <div class="submit-change">
    <a href="https://forms.gle/DEIN-FORM-LINK" target="_blank">
      🔔 Zeit Änderung melden
    </a>
  </div>
<!-- 订阅按钮 -->
<div style="margin-top:24px;">
  <button id="subscribePush"
          style="padding:10px 16px;border-radius:10px;background:#d6b86b;color:#fff;font-weight:600;border:none;cursor:pointer">
    🔔 订阅推送 / Push abonnieren
  </button>
</div>

<script>
  // 点击按钮 → 显示 OneSignal 的订阅弹窗
  document.getElementById('subscribePush').addEventListener('click', async () => {
    try {
      if (window.OneSignal) {
        const OneSignal = await window.OneSignalDeferred?.push((OS)=>OS) || window.OneSignal;
        // v16 推荐的 slidedown 触发
        OneSignal.Slidedown.promptPush();
      }
    } catch (e) { console.warn(e); }
  });
</script>

  <main>
    <h2>Bald verfügbar</h2>
    <p>Hier erscheinen täglich aktualisierte katholische Messzeiten,
       sortiert nach Nähe und in mehreren Sprachen verfügbar.</p>

    <!-- App Store Button -->
    <div class="store-buttons">
      <a href="#"><img src="appstore.png" alt="Download on the App Store"></a>
    </div>
  </main>

  <footer>
    © 2025 Messzeit.ch - entwickelt von Arcojo Creativ - Lin Nünlist
  </footer>
</body>
</html>
